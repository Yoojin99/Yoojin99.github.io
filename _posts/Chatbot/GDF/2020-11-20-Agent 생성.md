---
title:  "GDF - Agent 생성"
excerpt: ""

toc: true
toc_sticky: true
toc_label: "페이지 주요 목차"
header:
  teaser: 
  
  
categories:
  - Chatbot
  
tags:
  - Chatbot
  - GDF
last_modified_at: 2020-11-20
---

여기서는 Dialogflow CX로 어떻게 겨츠 주문 에이전트를 만들고 테스트하는지 보여준다. 이 에이전트와 대화하면서, 상점 위치, 영업 시간, 주문을 할 수 있다.

다 만들어진 에이전트는 아래와 같이 그래프화 될 수 있다.

![스크린샷 2020-11-20 오후 12 27 10](https://user-images.githubusercontent.com/41438361/99754443-bc705a80-2b2b-11eb-938b-62bd145d11de.png)

## 에이전트 만들기

1. Dialogflow CX Console을 연다.
2. GCP 프로젝트를 만들거나 고른다.
3. `+Create`를 누른다.
  ![스크린샷 2020-11-20 오후 12 25 04](https://user-images.githubusercontent.com/41438361/99754678-43253780-2b2c-11eb-8d89-ebb21aa90e22.png)
4. 폼에 기본 설정을 입력한다.
5. `Save`를 누른다.

## 기본 플로우와 의도

아래의 플로우와 의도는 새로운 agent를 위해 자동적으로 생성된다. `Manage`를 클릭하고, `Intents`를 클릭해서 intent를 찾을 수 있다. `Build`를 눌러서
플로우를 찾을 수 있다.

|기본 환영 Intent|기본 환영 intent는 "Hi"나 "Hello"와 같이 초기 사용자를 환영하기 위한 학습 문구를 가지고 있다. 이런 문구를 원할 시에 수정할 수 있다.
|기본 부정 Intent|기본 부정 intent는 부정적 예시와 같이 행동하는 intent에 학습 문장을 추가하는데 사용될 수 있다.
|기본 시작 flow|기본 시작 flow는 유일한 flow로 사용될 수 있다. 더 복잡한 agent에서, 더 많은 흐름을 추가할 수 있다.|

## 기본 환영 메세지 응답 테스트하기

기본 플로우와 intent는 환영 메세지로만 기본 대화를 다룰 수 있다. 테스트하려면 아래와 같이 하면 된다.

1. Test Agent 버튼을 클릭해서 시뮬레이터를 연다.
  ![스크린샷 2020-11-20 오후 1 40 35](https://user-images.githubusercontent.com/41438361/99759578-0100f380-2b36-11eb-954a-909deafe8e1a.png)
2. `hello`를 text entry에 입력하고 엔터를 눌러라.
3. Agent가 기본 환영 인사로 응답한다.
  ![스크린샷 2020-11-20 오후 1 42 00](https://user-images.githubusercontent.com/41438361/99759641-3279bf00-2b36-11eb-9b07-d7fcbd20d789.png)
4. 시뮬레이터를 닫아라.

참 편리하다... MS bot framework에서는 이런 것들을 하려면 qna maker를 이용하거나 일일히 코딩해줘야 했는데...

그리고 역시 한국어다보니 존댓말이나 파생어에 대해서는 학습이 부족한 듯한 모습을 보였다.

![스크린샷 2020-11-20 오후 1 43 43](https://user-images.githubusercontent.com/41438361/99760099-6fde4c80-2b36-11eb-9ba2-e0dbe15b7be5.png)

아래의 단계들이 agent가 이 사용자 입력을 처리하기 위해 이루어졌다.

1. 내가 말을 입력했을때, Default Start flow가 활성화된 흐름이고, 흐름의 시작 페이지가 활성화된 페이지이다. 각 상태 핸들러들은 scope에 있는 활성화된 플로우에 적용되고, agent가 그것을 평가한다.
2. 평가된 루트 중 하나는 intent 요구사항으로 기본 환영 intent를 가지고 있다. 내 입력이 이 intent과 일치했기 때문에 이 route가 불려진 것이다.
3. 불려진 루트는 여러개의 fulfillment 응답 메세지를 가지고 있다. Agent는 그 중 하나를 골라서 response queue에 추가한다.
4. 불러진 루트는 전환 타겟이 없기 때문에 활성화된 플로우와 페이지는 변하지 않는다.
5. Agent는 response 큐에 있는 컨텐츠로 응답을 한다.

### 환영 응답 메세지 수정하기

이 환영 인사를 수정할 수도 있다. 

1. Build 탭을 누른다.
2. Flow section에 있는 Default Start Flow를 선택한다.
  ![스크린샷 2020-11-20 오후 1 51 46](https://user-images.githubusercontent.com/41438361/99760663-8fc24000-2b37-11eb-85a3-850dfb1bda15.png)
3. 그래프에 있는 Start 노드를 클릭한다. 이것은 Default start flow의 시작 페이지이다.
  ![스크린샷 2020-11-20 오후 1 53 19](https://user-images.githubusercontent.com/41438361/99760750-cf892780-2b37-11eb-9a19-3698c61c78ef.png)
4. Default Welcome Intent를 찾고 클릭한다. 이것은 intent route 정보를 수정하는 판넬을 띄운다.
  ![스크린샷 2020-11-20 오후 1 56 10](https://user-images.githubusercontent.com/41438361/99760907-2d1d7400-2b38-11eb-810d-d964b6e5bb4d.png)
5. Fulfillment section을 찾고 모든 응답 메세지를 지우고 `Hello, this is a shirt ordering virtual agent. How can I help you?`를 입력한다.
  ![스크린샷 2020-11-20 오후 1 57 53](https://user-images.githubusercontent.com/41438361/99761018-69e96b00-2b38-11eb-9ec6-3d458b08b983.png)
6. Save를 누른다.
  ![스크린샷 2020-11-20 오후 2 01 06](https://user-images.githubusercontent.com/41438361/99761209-df553b80-2b38-11eb-81b8-cf7077cf4a84.png)

와 근데 확실히 인터페이스가 있으니까 같은 작업을 해도 더 편하게 느껴지는 것 같다.

### 업데이트 된 새로운 응답 메세지 테스트하기

1. Test Agent를 클릭해서 시뮬레이터를 연다.
2. 똑같이 안녕이라고 쳐본다.
3. 내가 지정한 메세지로 응답이 올 것이다.
4. 시뮬레이터를 닫는다.

![스크린샷 2020-11-20 오후 2 02 18](https://user-images.githubusercontent.com/41438361/99761264-07dd3580-2b39-11eb-9a95-bbb84fd4c252.png)

## 위치 페이지 저장하기

Dialogflow CX 대화(세션)은 상태 머신으로 시각화되어 설명될 수 있다. CX 세션의 상태는 페이지로 표현된다. 만약 오직 하나의 페이지만 갖고 있다면, agent는 별 쓸모가 없다.
이 파트에서, 가게의 위치를 물어보는 질문을 다루는 다른 페이지를 만들 것이다.

### 새로운 










